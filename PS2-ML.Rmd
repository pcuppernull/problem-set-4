---
title: "Problem Set 2"
author: "Pete Cuppernull"
date: "1/30/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Load Packages and Clean
```{r}
library(tidyverse)
library(modelr)
library(broom) 
library(rsample) 
library(patchwork)
library(corrplot)
library(ISLR)
library(caret)
library(rcfss)
library(yardstick)
library(stargazer)
biden <- read_csv("/Users/petecuppernull/Dropbox/UChicago/2019-20/Winter/Machine Learning/Repos/Problem-Set-2-ML/nes2008.csv")

biden <- biden %>%
  select(biden, female, age, educ, dem, rep) %>%
  na.omit()

```

# 1. Estimate MSE
```{r}
biden_traditional <- glm(biden ~ .,
                          data = biden)
biden_mse <- modelr::mse(biden_traditional, biden)

```

The MSE of the traditional model is `r biden_mse`.

#2. Simple Holdout Validation
```{r}
##Split data
set.seed(1414)
split <- initial_split(biden, prop = .5) 
biden_train <- training(split)
biden_test <- testing(split)

#Fit model w/ training data
biden_train_ho <- lm(biden ~ .,
                          data = biden_train)

summary(biden_train_ho)

#Validate model
biden_mse_test <- modelr::mse(biden_train_ho, biden_test)

```
The MSE of the training holdout model is `r biden_mse_test`. Considering that the MSE of the traditional model is `r biden_mse`, the simple holdout appraoch provides a more accurate learner. SOME EXPLANATION HERE

#3. Bootstrap
```{r}
mean_biden <- function(splits) {
  x <- analysis(splits)
  mean(x$biden)
}

##function for mse
biden_mse_boot <- function(split_data){
  
biden_train_ho <- lm(biden ~ .,
                          data = split_data)
biden_mse_train <- modelr::mse(biden_train_ho, split_data)
biden_mse_train
}


biden_bootstrap <- biden %>%
  bootstraps(1000) %>%
  mutate(mean = map_dbl(splits, mean_biden)) %>%
  mutate(mse_boot = map_dbl(splits, biden_mse_boot))
  
head(biden_bootstrap)

#Means
ggplot(biden_bootstrap) +
  geom_histogram(aes(mean)) +
  geom_vline(xintercept = mean(biden_bootstrap$mean)) +
  labs(x = "Mean",
       y = "Frequency",
       title = "Distribution of Means",
       subtitle = "1000 Bootstraps")

#MSE
ggplot(biden_bootstrap) +
  geom_histogram(aes(mse_boot)) +
  geom_vline(xintercept = mean(biden_bootstrap$mse_boot)) +
  labs(x = "MSE",
       y = "Frequency",
       title = "Distribution of MSE",
       subtitle = "1000 Bootstraps")
```
WRITE UP COMMENTS HERE

## Question 4. Comparison

Traditional
```{r}
stargazer(biden_traditional, type = "text")
stargazer(biden_bootstrap, type = "text")

biden_traditional <- glm(biden ~ .,
                          data = biden_bootstrap)
biden_mse <- modelr::mse(biden_traditional, biden)
```

Traditional
